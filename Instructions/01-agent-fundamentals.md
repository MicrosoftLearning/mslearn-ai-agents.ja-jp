---
lab:
  title: AI エージェントの開発について学習する
  description: AI エージェントの開発を始める最初の取り組みとして、Azure AI Foundry ポータル内で Azure AI エージェント サービスについて学習します。
---

# AI エージェントの開発について学習する

この演習では、Azure AI Foundry ポータル内で Azure AI エージェント サービスを使用して、経費請求に関して従業員を支援するシンプルな AI エージェントを作成します。

この演習は約 **30** 分かかります。

> **注**: この演習で使用されるテクノロジの一部は、プレビューの段階または開発中の段階です。 予期しない動作、警告、またはエラーが発生する場合があります。

## Azure AI Foundry プロジェクトとエージェントを作成する

まず、Azure AI Foundry プロジェクトを作成します。

1. Web ブラウザーで [Azure AI Foundry ポータル](https://ai.azure.com) (`https://ai.azure.com`) を開き、Azure 資格情報を使用してサインインします。 初めてサインインするときに開いたヒントまたはクイック スタート ウィンドウを閉じます。また、必要に応じて左上にある **Azure AI Foundry** ロゴを使用してホーム ページに移動します。それは次の画像のようになります (**[ヘルプ]** ウィンドウが開いている場合は閉じます)。

    ![Azure AI Foundry ポータルのスクリーンショット。](./Media/ai-foundry-home.png)

1. ホーム ページで、**[エージェントを作成する]** を選択します。
1. プロジェクトの作成を求められたら、プロジェクトの有効な名前を入力します。
1. **[詳細オプション]** を展開し、次の設定を指定します。
    - **Azure AI Foundry リソース**: *Azure AI Foundry リソースの有効な名前*
    - **[サブスクリプション]**:"*ご自身の Azure サブスクリプション*"
    - **リソース グループ**: *お手持ちのリソース グループを選択するか、新しいリソース グループを作成します*
    - **リージョン**: ***AI サービスでサポートされている場所を選択します***\*

    > \* 一部の Azure AI リソースは、リージョンのモデル クォータによって制限されます。 演習の後半でクォータ制限を超えた場合は、別のリージョンに別のリソースを作成する必要が生じる可能性があります。

1. **[作成]** を選択して、プロジェクトが作成されるまで待ちます。
1. プロジェクトが作成されると、エージェント プレイグラウンドが自動的に開かれ、モデルを選択あるいはデプロイできます。

    ![Azure AI Foundry プロジェクトのエージェント プレイグラウンドのスクリーンショット。](./Media/ai-foundry-agents-playground.png)

    >**注**: GPT-4o 基本モデルは、エージェントとプロジェクトの作成時に自動的にデプロイされます。

基本モデルのデプロイと共に、既定の名前のエージェントが自動的に作成されていることがわかります。

## エージェントを作成する

モデルがデプロイされたので、AI エージェントを構築する準備ができました。 この演習では、企業の経費ポリシーに基づいてユーザーの質問に回答するシンプルなエージェントを構築します。 経費ポリシー ドキュメントをダウンロードし、エージェントの*グラウンディング* データとして使用します。

1. 新しいブラウザー タブを開き、`https://raw.githubusercontent.com/MicrosoftLearning/mslearn-ai-agents/main/Labfiles/01-agent-fundamentals/Expenses_Policy.docx` から [Expenses_policy.docx](https://raw.githubusercontent.com/MicrosoftLearning/mslearn-ai-agents/main/Labfiles/01-agent-fundamentals/Expenses_Policy.docx) をダウンロードし、ローカルに保存します。 このドキュメントには、架空の Contoso 企業の経費ポリシーの詳細が含まれています。
1. Foundry エージェント プレイグラウンドを含むブラウザー タブに戻り、**[セットアップ]** ウィンドウを見つけます (チャット ウィンドウの横または下にあります)。
1. **[エージェント名]** を `ExpensesAgent` に設定し、前の手順で作成した gpt-4o モデル デプロイが選択されていることを確認し、**[手順]** を以下のように設定します。

    ```prompt
   You are an AI assistant for corporate expenses.
   You answer questions about expenses based on the expenses policy data.
   If a user wants to submit an expense claim, you get their email address, a description of the claim, and the amount to be claimed and write the claim details to a text file that the user can download.
    ```

    ![Azure AI Foundry ポータル内の AI エージェント セットアップ ページのスクリーンショット。](./Media/ai-agent-setup.png)

1. **[セットアップ]** ペインのさらに下の方の **[ナレッジ]** ヘッダーの横にある **[+ 追加]** を選択します。 次に、**[ナレッジの追加]** ダイアログ ボックスで、**[ファイル]** を選択します。
1. **[ファイルの追加]** ダイアログ ボックスで、`Expenses_Vector_Store` という名前の新しいベクター ストアを作成し、前にダウンロードした**Expenses_policy.docx** ローカル ファイルをアップロードして保存します。
1. **[セットアップ]** ペインの **[ナレッジ]** セクションで、**Expenses_Vector_Store** が「1 つのファイルを含む」としてリストに表示されているのを確認します。
1. **[ナレッジ]** セクションの下で **[アクション]** の横にある **[+ 追加]** を選択します。 次に、**[アクションの追加] ** ダイアログ ボックスで、**[コード インタープリター]** を選択し **[保存]** を選択します (コード インタープリター用のファイルをアップロードする必要はありません)。

    エージェントは、アップロードしたドキュメントをナレッジ ソースとして使用して、応答の*根拠*とします (つまり、このドキュメントの内容に基づいて質問に回答します)。 必要に応じてコード インタープリター ツールを使用し、独自の Python コードを生成して実行することでアクションを実行します。

## エージェントをテストする

エージェントを作成できたので、プレイグラウンド チャット内でテストしてみます。

1. プレイグラウンドのチャット入力フィールドにプロンプト `What's the maximum I can claim for meals?` を入力し、エージェントの応答を確認します。応答内容が、エージェントのセットアップ用ナレッジとして追加した経費ポリシー ドキュメントの情報に基づいているかチェックすること。

    > **注**: レート制限を超えたためにエージェントが応答に失敗した場合。 数秒待ってから、やり直してください。 サブスクリプションで使用可能なクォータが不足している場合は、モデルが応答できない可能性があります。 問題が解決しない場合は、**[モデル + エンドポイント]** ページでモデルのクォータを増やしてみてください。

1. 次のフォローアッププロンプトを試してください: `I'd like to submit a claim for a meal.`。そして応答を確認します。 エージェントは、要求を送信するために必要な情報を求める必要があります。
1. エージェントにメール アドレス (例: `fred@contoso.com`) を指定します。 エージェントは、応答を確認し、経費請求に必要な残りの情報 (説明と金額) を要求する必要があります。
1. 請求と金額を説明するプロンプト (例: `Breakfast cost me $20`) を送信します。
1. エージェントは、コード インタープリターを使用して経費請求のテキスト ファイルを準備し、ダウンロードできるようにリンクを提供する必要があります。

    ![Azure AI Foundry ポータル内のプレイグラウンドのスクリーンショット。](./Media/ai-agent-playground.png)

1. テキスト ドキュメントをダウンロードして開き、経費明細書の詳細を表示します。

## クリーンアップ

これで演習が完了したので、不要なリソース使用を避けるために、作成したクラウド リソースを削除してください。

1. `https://portal.azure.com` で [Azure ポータル](https://portal.azure.com) を開き、この演習で使用したハブ リソースをデプロイしたリソース グループの内容を表示します。
1. ツール バーの **[リソース グループの削除]** を選びます。
1. リソース グループ名を入力し、削除することを確認します。
